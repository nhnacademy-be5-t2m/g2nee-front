<!DOCTYPE html>
<html lang="en"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/adminLayout}" xmlns="http://www.w3.org/1999/html">
<head>
    <script th:inline="javascript">
        function addSelection(select, addSelection) {
            const container = document.getElementById(addSelection);
            const selection = document.getElementById(select)
            const cloneSelection = selection.cloneNode(true);

            const newId = select + '_' + (container.children.length + 1);
            cloneSelection.id = newId;

            const label = document.querySelector(`label[for="${select}"]`);
            const cloneLabel = label.cloneNode(true);
            cloneLabel.setAttribute('for', newId);

            container.appendChild(cloneLabel);
            container.appendChild(cloneSelection)

            event.preventDefault();
        }


    </script>

    <title>도서 등록</title>
</head>

<body>
<div layout:fragment="content">
    <div class="container">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <h2>도서 등록</h2>

                <form th:action="@{/admin/books/}" th:method="post" enctype="multipart/form-data">

                    <div class="form-group">
                        <label for="title">제목 (한글)</label>
                        <input type="text" id="title" name="title" pattern="^[[가-힣0-9a-zA-Z]+$" required>
                    </div>

                    <div class="form-group">
                        <label for="engTitle">제목 (영어)</label>
                        <input type="text" id="engTitle" name="engTitle" pattern="^[A-Za-z0-9]+$" required>
                    </div>

                    <div class="form-group">
                        <label for="bookIndex">목차</label>
                        <textarea type="text" id="bookIndex" name="bookIndex" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="description">설명</label>
                        <textarea id="description" name="description" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="thumbnail">썸네일 이미지</label>
                        <input type="file" id="thumbnail" name="thumbnail" accept="image/*" required>
                    </div>

                    <div class="form-group">
                        <label for="details">세부 이미지</label>
                        <input type="file" id="details" name="details" accept="image/*" multiple required>
                    </div>

                    <div class="form-group">
                        <label for="publishedDate">출판일</label>
                        <input type="date" id="publishedDate" name="publishedDate" required>
                    </div>

                    <div class="form-group">
                        <label for="price">가격</label>
                        <input type="number" id="price" name="price" pattern="\d+" required>
                    </div>

                    <div class="form-group">
                        <label for="salePrice">할인 가격</label>
                        <input type="number" id="salePrice" name="salePrice" pattern="\d+" required>
                    </div>

                    <div class="form-group">
                        <label for="isbn">ISBN</label>
                        <input type="text" id="isbn" name="isbn" required>
                    </div>

                    <div class="form-group">
                        <label for="pages">페이지 수</label>
                        <input type="number" id="pages" name="pages" pattern="\d+" required>
                    </div>
                    <div class="form-group">
                        <label for="quantity">수량</label>
                        <input type="number" id="quantity" name="quantity" pattern="\d+" required>
                    </div>

                    <div class="form-group">
                        <label for="category">카테고리 선택</label>
                        <input type="number" id="category" name="categoryIdList">
                    </div>

                    <div class="form-group">
                        <label for="publisherSelect">출판사 선택</label>
                        <select id="publisherSelect" name="publisherId" required>
                            <option value="">출판사를 선택해주세요</option>
                            <option th:each="publisher : ${publisherList}"
                                    th:value="${publisher.getPublisherId()}"
                                    th:text="${publisher.getPublisherName()}"></option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="contributorSelect">기여자 선택</label>
                        <div id="addContributorSelection">
                            <select id="contributorSelect" name="contributorIdList" required>
                                <option value="">기여자를 선택해주세요</option>
                                <option th:each="contributor : ${contributorList}"
                                        th:value="${contributor.getContributorId()}"
                                        th:text="${contributor.getContributorName()}"></option>
                            </select>

                            <label for="roleSelect">역할 선택</label>

                            <select id="roleSelect" name="roleIdList" required>
                                <option value="">역할을 선택해주세요</option>
                                <option th:each="role : ${roleList}"
                                        th:value="${role.getRoleId()}"
                                        th:text="${role.getRoleName()}">
                                </option>
                            </select>
                            <br>
                        </div>

                        <button onclick="addSelection('contributorSelect','addContributorSelection');addSelection('roleSelect','addContributorSelection')">
                            +
                        </button>
                    </div>

                    <div class="form-group">
                        <label for="tagSelect">태그 선택</label>
                        <div id="addTagSelection">
                            <select id="tagSelect" name="tagIdList" required>
                                <option value="">태그를 선택해주세요</option>
                                <option th:each="tag : ${tagList}"
                                        th:value="${tag.getTagId()}"
                                        th:text="${tag.getTagName()}"></option>
                            </select>
                            <br>
                        </div>
                        <button onclick="addSelection('tagSelect','addTagSelection')">+</button>
                    </div>

                    <input type="submit" th:value="등록">
                </form>
            </div>
        </div>
    </div>
</div>
</body>
</html>